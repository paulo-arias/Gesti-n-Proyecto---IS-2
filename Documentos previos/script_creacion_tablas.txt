
CREATE TABLE public.ITEMS (
                COD_ITEM VARCHAR NOT NULL,
                ESTADO VARCHAR NOT NULL,
                VERSION VARCHAR NOT NULL,
                PRIORIDAD VARCHAR NOT NULL,
                ESTADO_1 VARCHAR NOT NULL,
                DESCRIPCION VARCHAR NOT NULL,
                OBS VARCHAR NOT NULL,
                CONSTRAINT items_pk PRIMARY KEY (COD_ITEM)
);


CREATE TABLE public.LINEA_BASE (
                COD_LINEA_BASE VARCHAR NOT NULL,
                NOMBRE VARCHAR NOT NULL,
                DESCRIPCION VARCHAR NOT NULL,
                CONSTRAINT linea_base_pk PRIMARY KEY (COD_LINEA_BASE)
);


CREATE TABLE public.LB_ITEM (
                COD_ITEM VARCHAR NOT NULL,
                COD_LINEA_BASE VARCHAR NOT NULL,
                CONSTRAINT lb_item_pk PRIMARY KEY (COD_ITEM, COD_LINEA_BASE)
);


CREATE TABLE public.FASE (
                COD_FASE VARCHAR NOT NULL,
                COD_LINEA_BASE VARCHAR NOT NULL,
                ESTADO VARCHAR NOT NULL,
                CONSTRAINT fase_pk PRIMARY KEY (COD_FASE, COD_LINEA_BASE)
);


CREATE TABLE public.PROYECTO (
                COD_PROY VARCHAR NOT NULL,
                NOMBRE_PROY VARCHAR NOT NULL,
                ESTADO VARCHAR NOT NULL,
                CONSTRAINT proyecto_pk PRIMARY KEY (COD_PROY)
);


CREATE TABLE public.FASE_PROYECTO (
                COD_PROY VARCHAR NOT NULL,
                COD_FASE VARCHAR NOT NULL,
                CONSTRAINT fase_proyecto_pk PRIMARY KEY (COD_PROY, COD_FASE)
);


CREATE TABLE public.USUARIO (
                COD_USUARIO VARCHAR NOT NULL,
                CEDULA VARCHAR NOT NULL,
                NOMBRE VARCHAR NOT NULL,
                APELLIDO VARCHAR NOT NULL,
                TELEFONO VARCHAR NOT NULL,
                COD_ROL VARCHAR NOT NULL,
                CONSTRAINT usuario_pk PRIMARY KEY (COD_USUARIO)
);


CREATE TABLE public.ROL (
                IDROL NUMERIC NOT NULL,
                NOMBRE VARCHAR NOT NULL,
                PERMISO VARCHAR NOT NULL,
                CONSTRAINT idrol PRIMARY KEY (IDROL)
);


CREATE TABLE public.USUARIO_ROL (
                COD_USUARIO VARCHAR NOT NULL,
                IDROL NUMERIC NOT NULL,
                COD_PROY VARCHAR NOT NULL,
                CONSTRAINT usuario_rol_pk PRIMARY KEY (COD_USUARIO, IDROL, COD_PROY)
);


ALTER TABLE public.LB_ITEM ADD CONSTRAINT items_lb_item_fk
FOREIGN KEY (COD_ITEM)
REFERENCES public.ITEMS (COD_ITEM)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE public.FASE ADD CONSTRAINT linea_base_fase_fk
FOREIGN KEY (COD_LINEA_BASE)
REFERENCES public.LINEA_BASE (COD_LINEA_BASE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE public.LB_ITEM ADD CONSTRAINT linea_base_lb_item_fk
FOREIGN KEY (COD_LINEA_BASE)
REFERENCES public.LINEA_BASE (COD_LINEA_BASE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE public.FASE_PROYECTO ADD CONSTRAINT fase_fase_proyecto_fk
FOREIGN KEY (COD_FASE)
REFERENCES public.FASE (COD_FASE)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE public.USUARIO_ROL ADD CONSTRAINT proyecto_usuario_rol_fk
FOREIGN KEY (COD_PROY)
REFERENCES public.PROYECTO (COD_PROY)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE public.FASE_PROYECTO ADD CONSTRAINT proyecto_fase_proyecto_fk
FOREIGN KEY (COD_PROY)
REFERENCES public.PROYECTO (COD_PROY)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE public.USUARIO_ROL ADD CONSTRAINT usuario_usuario_rol_fk
FOREIGN KEY (COD_USUARIO)
REFERENCES public.USUARIO (COD_USUARIO)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;

ALTER TABLE public.USUARIO_ROL ADD CONSTRAINT rol_usuario_rol_fk
FOREIGN KEY (IDROL)
REFERENCES public.ROL (IDROL)
ON DELETE NO ACTION
ON UPDATE NO ACTION
NOT DEFERRABLE;